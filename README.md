# TCP-Fuzzer üåêüì†
TCP-Fuzzer is a tool for protocol-state-fuzzing TCP implementations. The tool is currently WIP and undergoing major restructuring.

# Requirements
The tool can be deployed in an isolated environment using Docker (containerized), or directly on the host system (local).
For an isolated deployment, you only need Docker.
For a local deployment, the tool needs Python 3.12 (or later), Java JDK 17 (or later), and Maven for deployment.
Currently, non-Java part of the tool has been tested only on Linux and on other OS-es, if the tool is deployed locally.

# Development status
Docker support is WIP, and not yet guaranteed to work.
Socket commands are not yet supported in the _Mapper_.


# Installation (local)

`cd` to the fuzzer directory. Next install the _Learner_:
```
cd lea
```

# Components

##### Learner
_Learner_ is Java tool based on [ProtocolState-Fuzzer][psf], which interacts with TCP entities (sending input symbols/receiving output symbols) to construct state machine models capturing their behavior.
It uses a _Mapper_ to mediate communication with the TCP entity.

The input alphabet (i.e., possible input symbols) comprises:
- segment inputs, which indicate the flag configurations to be used in the segments to be sent to the SUT, e.g., "S" means to generate a segment with the SYN flag set (a so-called SYN segment);
- socket commands, which indicate the socket commands the _Mapper_ should perform on the TCP stack.

The output alphabet (i.e., possible output symbols)  comprises:
- no response ("Timeout") in case the SUT produced no output (segments) in response to an input;
- segment outputs, which indicate the the flag configurations of the segments generated by the SUT, e.g., "SA" means the SUT has generated a segment with the SYN and ACK flags set (a so-called SYN+ACK segment).

##### Mapper

_Mapper_ (previously known as Network Adapter) is a Python tool which performs a dual function:
- it transforms segment inputs to actual segments and sends them to _TCP Entity_, or forwards socket commands to the _TCP Adapter_ for execution;
- it receives segment responses, or timeouts, from the TCP Entity, abstracts them into output symbols (e.g., by extracting the flag configuration) which it delivers to the _Learner_.

##### TCP Adapter and Entity

_TCP Entity_ is your TCP stack, which can be either a Server or a Client. _TCP Adapter_ envelops a _TCP Entity_, and is used to perform socket commands on it.

# Walkthrough
Running TCP-Fuzzer requires


# Installation (docker)
install docker and docker compose, edit the files in the config folder to your liking and run

```
docker-compose up
```
# Acknowledgements
The tool was originally developed by Isaac Westerman as part of his Bachelor's thesis. The code is based on [tcp-learner](https://github.com/pfg666/tcp-learner), a TCP protocol-state fuzzer developed by Paul Fiterau and Ramon Janssen.

[psf]:https://github.com/protocol-fuzzing/protocol-state-fuzzer/
[tcplearner]:https://github.com/pfg666/tcp-learner
